(("undefined"!==typeof self?self:this)["webpackChunkelemental_3_0_2_rc_1"]=("undefined"!==typeof self?self:this)["webpackChunkelemental_3_0_2_rc_1"]||[]).push([[739],{87736:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return F}});var o=t(9274);const n={class:"col span-12"},l={class:"row mb-20"},s={class:"col span-6"},r={key:0,class:"mb-20"},i={class:"row mb-40"},d={class:"col span-12"},c={class:"mt-10"},m={class:"row mb-30"},u={class:"row mb-10"},h={class:"row mb-30"},p={class:"row mb-10"};function v(e,a,t,v,g,b){const y=(0,o.resolveComponent)("Loading"),C=(0,o.resolveComponent)("NameNsDescription"),V=(0,o.resolveComponent)("YamlEditor"),N=(0,o.resolveComponent)("FileSelector"),f=(0,o.resolveComponent)("Banner"),k=(0,o.resolveComponent)("KeyValue"),E=(0,o.resolveComponent)("Tab"),A=(0,o.resolveComponent)("Tabbed"),w=(0,o.resolveComponent)("CruResource"),I=(0,o.resolveDirective)("clean-html");return t.value?((0,o.openBlock)(),(0,o.createBlock)(w,{key:1,"done-route":e.doneRoute,"can-yaml":!0,mode:t.mode,resource:t.value,errors:e.errors,"validation-passed":g.isFormValid,onError:a[5]||(a[5]=a=>e.errors=a),onFinish:b.save,onCancel:e.done},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(["row mb-40",{"mt-40":!b.hasBeenCreated}])},[(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("h3",null,(0,o.toDisplayString)(e.t("elemental.machineRegistration.create.configuration")),1),(0,o.createVNode)(C,{value:t.value,mode:t.mode,"description-hidden":!0,namespaced:!1},null,8,["value","mode"])])],2),(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("h3",null,(0,o.toDisplayString)(e.t("elemental.machineRegistration.create.cloudConfiguration")),1),((0,o.openBlock)(),(0,o.createBlock)(V,{key:g.rerender,ref:"yamleditor",value:g.cloudConfig,"onUpdate:value":a[0]||(a[0]=e=>g.cloudConfig=e),class:"mb-20","editor-mode":b.editorMode},null,8,["value","editor-mode"])),b.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createVNode)(N,{class:"btn role-secondary","data-testid":"read-from-file-btn",label:e.t("elemental.machineRegistration.create.readFromFile"),onSelected:b.onFileSelected},null,8,["label","onSelected"])])),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(g.yamlErrors,((e,a)=>((0,o.openBlock)(),(0,o.createBlock)(f,{key:a,color:"error",label:e},null,8,["label"])))),128))])]),(0,o.createElementVNode)("div",i,[(0,o.createElementVNode)("div",d,[(0,o.createElementVNode)("h3",c,(0,o.toDisplayString)(e.t("elemental.machineRegistration.create.labelsAndAnnotations")),1),(0,o.createVNode)(A,{"data-testid":"labels-and-annotations-block"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(E,{"label-key":"elemental.machineRegistration.create.machineInv",name:"machine-inventory","data-testid":"mach-inv-tab",weight:3},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(f,{class:"mb-40",color:"info","data-testid":"mach-inv-banner"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("div",null,null,512),[[I,e.t("elemental.machineRegistration.create.labelsAndAnnotationsMachInvBanner",{},!0)]])])),_:1}),(0,o.createElementVNode)("div",m,[(0,o.createVNode)(k,{key:"labels","data-testid":"add-label-mach-inv",value:t.value.machineInventoryLabels,"add-label":e.t("labels.addLabel"),mode:t.mode,title:e.t("labels.labels.title"),"read-allowed":!1,"value-can-be-empty":!0,"onUpdate:value":a[1]||(a[1]=e=>b.updateLabels(e))},null,8,["value","add-label","mode","title"])]),(0,o.createElementVNode)("div",u,[(0,o.createVNode)(k,{key:"annotations","data-testid":"add-annotation-mach-inv",value:t.value.machineInventoryAnnotations,"add-label":e.t("labels.addAnnotation"),mode:t.mode,title:e.t("labels.annotations.title"),"read-allowed":!1,"value-can-be-empty":!0,"onUpdate:value":a[2]||(a[2]=e=>t.value.setAnnotations(e,"machineInventoryAnnotations",!0))},null,8,["value","add-label","mode","title"])])])),_:1}),(0,o.createVNode)(E,{"label-key":"elemental.machineRegistration.create.machineReg",name:"machine-reg","data-testid":"mach-reg-tab",weight:2},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(f,{class:"mb-40",color:"info","data-testid":"mach-reg-banner"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("div",null,null,512),[[I,e.t("elemental.machineRegistration.create.labelsAndAnnotationsMachRegBanner",{},!0)]])])),_:1}),(0,o.createElementVNode)("div",h,[(0,o.createVNode)(k,{key:"labels","data-testid":"add-label-mach-reg",value:t.value.labels,"add-label":e.t("labels.addLabel"),mode:t.mode,title:e.t("labels.labels.title"),"read-allowed":!1,"value-can-be-empty":!0,"onUpdate:value":a[3]||(a[3]=e=>t.value.setLabels(e))},null,8,["value","add-label","mode","title"])]),(0,o.createElementVNode)("div",p,[(0,o.createVNode)(k,{key:"annotations","data-testid":"add-annotation-mach-reg",value:t.value.annotations,"add-label":e.t("labels.addAnnotation"),mode:t.mode,title:e.t("labels.annotations.title"),"read-allowed":!1,"value-can-be-empty":!0,"onUpdate:value":a[4]||(a[4]=e=>t.value.setAnnotations(e))},null,8,["value","add-label","mode","title"])])])),_:1})])),_:1})])])])),_:1},8,["done-route","mode","resource","errors","validation-passed","onFinish","onCancel"])):((0,o.openBlock)(),(0,o.createBlock)(y,{key:0}))}var g=t(87619),b=t(52115),y=t(91825),C=t(9980),V=t(67850),N=t(29649),f=t(86078),k=t(40527),E=t(20246),A=t.n(E),w=t(52946),I=t(14220),L=t(99726),S=t(63209),O=t(42411),B=t(58168),R=t(54374),_={name:"MachineRegistrationEditView",components:{Loading:g.A,CruResource:b.A,YamlEditor:V.A,KeyValue:f.A,Banner:C.l,FileSelector:N.A,NameNsDescription:k.A,Tabbed:S.A,Tab:O.A},mixins:[y.A],props:{value:{type:Object,required:!0},mode:{type:String,required:!0}},async fetch(){if(this.mode===I.YQ){const e=await(0,B.fP)(this.$store);this.newCloudConfigcompatibilityCheck=(0,B.oi)(this.value.type,this.mode,B.ni,e),this.value.spec||(this.value.spec=this.newCloudConfigcompatibilityCheck?R.DEFAULT_CREATION_YAML:R.OLD_DEFAULT_CREATION_YAML),this.cloudConfig="string"===typeof this.value.spec?this.value.spec:(0,w.Kq)(this.value.spec),this.rerender=!0}},data(){return{rerender:!1,cloudConfig:"string"===typeof this.value.spec?this.value.spec:(0,w.Kq)(this.value.spec),newCloudConfigcompatibilityCheck:!1,yamlErrors:null,isFormValid:!0}},watch:{cloudConfig:{handler(e){try{const a=A().load(e);this.value.spec=a,this.yamlErrors=null}catch(a){this.yamlErrors=(0,L.rz)(a)}},immediate:!0}},computed:{isCreate(){return this.mode===I.YQ},isView(){return this.mode!==I.YQ&&this.mode!==I.G5},editorMode(){return this.isView?V.j.VIEW_CODE:V.j.EDIT_CODE},hasBeenCreated(){return!!this.value.id}},methods:{async save(e){this.errors=[];try{await this.value.save(),e(!0),this.isCreate?this.$router.replace(this.value.detailLocation):this.done()}catch(a){this.errors=(0,L.rz)(a),e(!1)}},updateLabels(e){this.value.setLabels(e,"machineInventoryLabels",!0);let a=!1,t=!1,o=!1,n=!1;this.errors=[],this.value.spec.machineInventoryLabels&&Object.keys(this.value.spec.machineInventoryLabels).length&&Object.keys(this.value.spec.machineInventoryLabels).forEach((e=>{if(e.includes("/")){const a=e.split("/")[0],n=e.split("/")[1];a.length>253&&(t=!0),n.length>63&&(o=!0)}else e.length>63&&(a=!0);this.value.spec.machineInventoryLabels[e].length>63&&(n=!0)})),n||a||t||o?(n&&(this.isFormValid=!1,this.errors.push(this.t("elemental.machineRegistration.validation.machineInventoryLabelValueLength"))),a&&(this.isFormValid=!1,this.errors.push(this.t("elemental.machineRegistration.validation.machineInventoryLabelKeyLength"))),t&&(this.isFormValid=!1,this.errors.push(this.t("elemental.machineRegistration.validation.machineInventoryLabelKeyPrefixLength"))),o&&(this.isFormValid=!1,this.errors.push(this.t("elemental.machineRegistration.validation.machineInventoryLabelKeyNameLength")))):this.isFormValid=!0},onFileSelected(e){const a=this.$refs.yamleditor;a&&a.updateValue(e)}}},D=t(47433);const M=(0,D.A)(_,[["render",v]]);var F=M},76436:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return I}});var o=t(9274);const n={class:"row mt-40 mb-20"},l={class:"col span-12 mb-20"},s={key:0,class:"row mb-20"},r={class:"col span-6 mb-20"},i={class:"user-warn mb-20"},d={key:0},c={key:1};function m(e,a,t,m,u,h){const p=(0,o.resolveComponent)("Loading"),v=(0,o.resolveComponent)("NameNsDescription"),g=(0,o.resolveComponent)("LabeledSelect"),b=(0,o.resolveComponent)("RadioGroup"),y=(0,o.resolveComponent)("LabeledInput"),C=(0,o.resolveComponent)("CruResource"),V=(0,o.resolveDirective)("clean-html");return t.value?((0,o.openBlock)(),(0,o.createBlock)(C,{key:1,"done-route":e.doneRoute,"can-yaml":!0,mode:t.mode,resource:t.value,errors:e.errors,onError:a[4]||(a[4]=a=>e.errors=a),onFinish:e.save,onCancel:e.done},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("h3",null,(0,o.toDisplayString)(e.t("elemental.osimage.create.configuration")),1),(0,o.createVNode)(v,{value:t.value,mode:t.mode,"description-hidden":!0,namespaced:!1},null,8,["value","mode"])])]),t.value.spec?((0,o.openBlock)(),(0,o.createElementBlock)("div",s,[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("h3",null,(0,o.toDisplayString)(e.t("elemental.osimage.create.spec")),1),(0,o.createVNode)(g,{value:u.clusterTargets,class:"mb-10","data-testid":"cluster-target",label:e.t("elemental.osimage.create.targetCluster.label"),placeholder:e.t("elemental.osimage.create.targetCluster.placeholder",null,!0),mode:t.mode,options:u.clusterTargetOptions,"option-key":"value",multiple:!0,"onUpdate:value":a[0]||(a[0]=e=>h.handleClusterTargetChange(e))},null,8,["value","label","placeholder","mode","options"]),(0,o.withDirectives)((0,o.createElementVNode)("p",i,null,512),[[V,e.t("elemental.osimage.create.userWarning",{},!0)]]),(0,o.createVNode)(b,{value:u.useManagedOsImages,class:"mb-20","data-testid":"upgrade-choice-selector",name:"os-image-mode",options:[!0,!1],labels:[e.t("elemental.osimage.create.radioOptions.osImages"),e.t("elemental.osimage.create.radioOptions.registry")],mode:t.mode,"onUpdate:value":a[1]||(a[1]=e=>h.handleRadioBtnChange(e))},null,8,["value","labels","mode"]),u.useManagedOsImages?((0,o.openBlock)(),(0,o.createElementBlock)("div",d,[(0,o.createVNode)(g,{value:u.osVersionSelected,"data-testid":"os-version-box",mode:t.mode,options:h.managedOSVersionOptions,"label-key":"elemental.osimage.create.managedOsImage.label",placeholder:e.t("elemental.osimage.create.managedOsImage.placeholder",null,!0),"option-key":"value","onUpdate:value":a[2]||(a[2]=e=>h.handleManagedOSVersionNameChange(e))},null,8,["value","mode","options","placeholder"])])):((0,o.openBlock)(),(0,o.createElementBlock)("div",c,[(0,o.createVNode)(y,{value:t.value.spec.osImage,"onUpdate:value":a[3]||(a[3]=e=>t.value.spec.osImage=e),valueModifiers:{trim:!0},"data-testid":"os-image-box",label:e.t("elemental.osimage.create.osImage.label"),placeholder:e.t("elemental.osimage.create.osImage.placeholder",null,!0),mode:t.mode},null,8,["value","label","placeholder","mode"])]))])])):(0,o.createCommentVNode)("",!0)])),_:1},8,["done-route","mode","resource","errors","onFinish","onCancel"])):((0,o.openBlock)(),(0,o.createBlock)(p,{key:0}))}var u=t(87619),h=t(52115),p=t(91825),v=t(22128),g=t(28623),b=t(40527),y=t(88268),C=t(88339),V=t(14220),N=t(35664),f=t(22213),k=t(25954),E={name:"ManagedOsImagesEditView",components:{Loading:u.A,LabeledInput:v.o,LabeledSelect:g.A,CruResource:h.A,NameNsDescription:b.A,RadioGroup:y.z},mixins:[p.A],props:{value:{type:Object,required:!0},mode:{type:String,required:!0}},async fetch(){const e={};e.rancherClusters=this.$store.dispatch("management/findAll",{type:N.qt.RANCHER_CLUSTER}),e.osGroups=this.$store.dispatch("management/findAll",{type:f.Ph.MANAGED_OS_IMAGES}),e.osVersions=this.$store.dispatch("management/findAll",{type:f.Ph.MANAGED_OS_VERSIONS}),e.osVersionChannels=this.$store.dispatch("management/findAll",{type:f.Ph.MANAGED_OS_VERSION_CHANNELS});const a=await(0,C.kR)(e);if(this.elementalClusters=(0,k.AF)(a.rancherClusters||[]),this.osGroups=a.osGroups||[],this.osVersions=a.osVersions||[],this.osVersionChannels=a.osVersionChannels||[],(this.mode===V.G5||this.mode===V.nW)&&(this.value?.spec?.managedOSVersionName?(this.osVersionSelected=this.value?.spec?.managedOSVersionName,this.useManagedOsImages=!0):this.useManagedOsImages=!1,this.value?.spec?.clusterTargets?.length)){const e=[];this.value?.spec?.clusterTargets.forEach((a=>{e.push(a.clusterName)})),this.clusterTargets=e}const t=(0,k.LR)(this.elementalClusters,this.osGroups,this.value.id);this.clusterTargetOptions=t.map((e=>({label:e.name,value:e.name})))},data(){return{elementalClusters:[],osGroups:[],osVersions:[],osVersionChannels:[],clusterTargets:[],clusterTargetOptions:[],useManagedOsImages:!0,osVersionSelected:""}},computed:{managedOSVersionOptions(){const e=[];return this.osVersionChannels.forEach((a=>{const t=this.osVersions.filter((e=>{const t=e.metadata?.ownerReferences.find((e=>e.name===a.name&&this.value?.metadata?.namespace===a.metadata?.namespace));return t&&Object.keys(t).length&&this.value?.metadata?.namespace===e.metadata?.namespace&&"container"===e.spec?.type}));t.length&&(e.push({kind:"group",label:this.t("elemental.osimage.create.managedOsImage.channel",{name:a.name}),value:this.t("elemental.osimage.create.managedOsImage.channel",{name:a.name})}),t.forEach((a=>{e.push({label:a.name,value:a.name})})))})),e},isCreate(){return this.mode===V.YQ}},methods:{handleClusterTargetChange(e){this.value.spec.clusterTargets=e.map((e=>({clusterName:e}))),this.clusterTargets=e},handleManagedOSVersionNameChange(e){this.value.spec.managedOSVersionName=e,this.osVersionSelected=e},handleRadioBtnChange(e){e?delete this.value?.spec?.osImage:(delete this.value?.spec?.managedOSVersionName,this.osVersionSelected=""),this.useManagedOsImages=e}}},A=(t(25687),t(47433));const w=(0,A.A)(E,[["render",m],["__scopeId","data-v-5331f5b4"]]);var I=w},94738:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return C}});var o=t(9274);const n={class:"row mt-40 mb-20"},l={class:"col span-12 mb-20"},s={key:0,class:"row mb-20"},r={class:"col span-8 mb-20"};function i(e,a,t,i,d,c){const m=(0,o.resolveComponent)("Loading"),u=(0,o.resolveComponent)("NameNsDescription"),h=(0,o.resolveComponent)("LabeledInput"),p=(0,o.resolveComponent)("Checkbox"),v=(0,o.resolveComponent)("CruResource");return t.value?((0,o.openBlock)(),(0,o.createBlock)(v,{key:1,"done-route":e.doneRoute,"can-yaml":!0,mode:t.mode,resource:t.value,errors:e.errors,onError:a[2]||(a[2]=a=>e.errors=a),onFinish:e.save,onCancel:e.done},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("h3",null,(0,o.toDisplayString)(e.t("elemental.osversionchannels.create.configuration")),1),(0,o.createVNode)(u,{value:t.value,mode:t.mode,"description-hidden":!0,namespaced:!1},null,8,["value","mode"])])]),t.value.spec?((0,o.openBlock)(),(0,o.createElementBlock)("div",s,[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("h3",null,(0,o.toDisplayString)(e.t("elemental.osversionchannels.create.spec")),1),(0,o.createVNode)(h,{value:t.value.spec.options.image,"onUpdate:value":a[0]||(a[0]=e=>t.value.spec.options.image=e),valueModifiers:{trim:!0},"data-testid":"os-version-channel-path",label:e.t("elemental.osversionchannels.create.registryUri.label"),placeholder:e.t("elemental.osversionchannels.create.registryUri.placeholder",null,!0),mode:t.mode},null,8,["value","label","placeholder","mode"]),c.supportsNoLongerInSyncChannelDeletion?((0,o.openBlock)(),(0,o.createBlock)(p,{key:0,value:t.value.spec.deleteNoLongerInSyncVersions,"onUpdate:value":a[1]||(a[1]=e=>t.value.spec.deleteNoLongerInSyncVersions=e),mode:t.mode,label:e.t("elemental.osversionchannels.create.automaticDelete"),"data-testid":"os-version-channel-automatic-deletion",class:"mt-20"},null,8,["value","mode","label"])):(0,o.createCommentVNode)("",!0)])])):(0,o.createCommentVNode)("",!0)])),_:1},8,["done-route","mode","resource","errors","onFinish","onCancel"])):((0,o.openBlock)(),(0,o.createBlock)(m,{key:0}))}var d=t(87619),c=t(52115),m=t(91825),u=t(22128),h=t(40527),p=t(6710),v=t(58168),g={name:"ManagedOsVersionChannelEditView",components:{Loading:d.A,LabeledInput:u.o,CruResource:c.A,NameNsDescription:h.A,Checkbox:p.A},mixins:[m.A],props:{value:{type:Object,required:!0},mode:{type:String,required:!0}},async fetch(){this.operatorVersion=await(0,v.fP)(this.$store)},data(){return{operatorVersion:""}},computed:{supportsNoLongerInSyncChannelDeletion(){return(0,v.oi)(this.value.type,this.mode,v.Hj,this.operatorVersion)}}},b=t(47433);const y=(0,b.A)(g,[["render",i]]);var C=y},27127:function(e,a,t){"use strict";t.r(a);var o=t(36758),n=t.n(o),l=t(40935),s=t.n(l),r=s()(n());r.push([e.id,".user-warn[data-v-5331f5b4]{font-size:13px;color:var(--darker)}",""]),a["default"]=r},25687:function(e,a,t){var o=t(27127);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var n=t(74825).A;n("4cebbf70",o,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=elemental-3.0.2-rc.1.umd.min.edit.js.map